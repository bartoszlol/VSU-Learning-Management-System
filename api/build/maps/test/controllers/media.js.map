{"version":3,"sources":["test/controllers/media.ts"],"names":[],"mappings":"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","file":"../../../test/controllers/media.js","sourcesContent":["import {Server} from '../../src/server';\r\nimport * as chai from 'chai';\r\nimport chaiHttp = require('chai-http');\r\nimport {TestHelper} from '../TestHelper';\r\nimport {FixtureUtils} from '../../fixtures/FixtureUtils';\r\nimport {JwtUtils} from '../../src/security/JwtUtils';\r\nimport {Directory} from '../../src/models/mediaManager/Directory';\r\nimport {File} from '../../src/models/mediaManager/File';\r\nimport {Course} from '../../src/models/Course';\r\nimport config from '../../src/config/main';\r\nimport * as fs from 'fs';\r\n\r\nchai.use(chaiHttp);\r\nconst should = chai.should();\r\nconst app = new Server().app;\r\nconst BASE_URL = '/api/media';\r\nconst testHelper = new TestHelper(BASE_URL);\r\n\r\n/**\r\n * Common unit test setup helper function.\r\n */\r\nasync function commonSetup () {\r\n  const course = await FixtureUtils.getRandomCourse();\r\n  const teacher = await FixtureUtils.getRandomTeacherForCourse(course);\r\n  return {course, teacher};\r\n}\r\n\r\ndescribe('Media', async () => {\r\n  beforeEach(() => testHelper.resetForNextTest());\r\n\r\n  describe(`GET ${BASE_URL}`, async () => {\r\n    async function commonGetSetup (withDirectories = true) {\r\n      const {course, teacher} = await commonSetup();\r\n\r\n      const file = await new File({\r\n        _course: course._id.toString(),\r\n        name: 'root',\r\n        link: 'test/a',\r\n        size: 129\r\n      }).save();\r\n      const subDirectory = withDirectories && await new Directory({\r\n        _course: course._id.toString(),\r\n        name: 'sub'\r\n      }).save();\r\n      const rootDirectory = withDirectories && await new Directory({\r\n        _course: course._id.toString(),\r\n        name: 'root',\r\n        subDirectories: [subDirectory],\r\n        files: [file]\r\n      }).save();\r\n\r\n      return {course, teacher, file, subDirectory, rootDirectory};\r\n    }\r\n\r\n    it('should get a directory', async () => {\r\n      const {teacher, file, subDirectory, rootDirectory} = await commonGetSetup(true);\r\n\r\n      const result = await testHelper.commonUserGetRequest(teacher, `/directory/${rootDirectory.id}`);\r\n      result.status.should.be.equal(200,\r\n        'could not get directory' +\r\n        ' -> ' + result.body.message);\r\n      result.body.name.should.equal(rootDirectory.name);\r\n      result.body.subDirectories.should.be.instanceOf(Array)\r\n        .and.have.lengthOf(1)\r\n        .and.contains(subDirectory.id);\r\n      result.body.files.should.be.instanceOf(Array)\r\n        .and.have.lengthOf(1)\r\n        .and.contains(file.id);\r\n    });\r\n\r\n    it('should fail to get a directory for an unauthorized user', async () => {\r\n      const {course, rootDirectory} = await commonGetSetup(true);\r\n      const unauthorizedUser = await FixtureUtils.getUnauthorizedTeacherForCourse(course);\r\n\r\n      const result = await testHelper.commonUserGetRequest(unauthorizedUser, `/directory/${rootDirectory.id}`);\r\n      result.status.should.be.equal(403);\r\n    });\r\n\r\n    it('should get a populated directory', async () => {\r\n      const {teacher, file, subDirectory, rootDirectory} = await commonGetSetup(true);\r\n\r\n      const result = await testHelper.commonUserGetRequest(teacher, `/directory/${rootDirectory.id}/lazy`);\r\n      result.status.should.be.equal(200,\r\n        'could not get directory' +\r\n        ' -> ' + result.body.message);\r\n      result.body._id.should.be.equal(rootDirectory.id);\r\n      result.body.name.should.equal(rootDirectory.name);\r\n      result.body.subDirectories.should.be.instanceOf(Array)\r\n        .and.have.lengthOf(1);\r\n      result.body.subDirectories[0]._id.should.be.equal(subDirectory.id);\r\n      result.body.subDirectories[0].name.should.be.equal(subDirectory.name);\r\n      result.body.subDirectories[0].subDirectories.should.be.instanceOf(Array)\r\n        .and.have.lengthOf(subDirectory.subDirectories.length);\r\n      result.body.subDirectories[0].files.should.be.instanceOf(Array)\r\n        .and.have.lengthOf(subDirectory.files.length);\r\n      result.body.files.should.be.instanceOf(Array)\r\n        .and.have.lengthOf(1);\r\n      result.body.files[0]._id.should.be.equal(file.id);\r\n      result.body.files[0].name.should.be.equal(file.name);\r\n      result.body.files[0].size.should.be.equal(file.size);\r\n      result.body.files[0].link.should.be.equal(file.link);\r\n    });\r\n\r\n    it('should fail to get a populated directory for an unauthorized user', async () => {\r\n      const {course, rootDirectory} = await commonGetSetup(true);\r\n      const unauthorizedUser = await FixtureUtils.getUnauthorizedTeacherForCourse(course);\r\n\r\n      const result = await testHelper.commonUserGetRequest(unauthorizedUser, `/directory/${rootDirectory.id}/lazy`);\r\n      result.status.should.be.equal(403);\r\n    });\r\n\r\n    it('should get a file', async () => {\r\n      const {teacher, file} = await commonGetSetup(false);\r\n\r\n      const result = await testHelper.commonUserGetRequest(teacher, `/file/${file.id}`);\r\n      result.status.should.be.equal(200,\r\n        'could not get file' +\r\n        ' -> ' + result.body.message);\r\n      result.body._id.should.be.equal(file.id);\r\n      result.body.name.should.be.equal(file.name);\r\n      result.body.size.should.be.equal(file.size);\r\n      result.body.link.should.be.equal(file.link);\r\n    });\r\n\r\n    it('should fail to get a file for an unauthorized user', async () => {\r\n      const {course, file} = await commonGetSetup(false);\r\n      const unauthorizedUser = await FixtureUtils.getUnauthorizedTeacherForCourse(course);\r\n\r\n      const result = await testHelper.commonUserGetRequest(unauthorizedUser, `/file/${file.id}`);\r\n      result.status.should.be.equal(403);\r\n    });\r\n  });\r\n\r\n  describe(`POST ${BASE_URL}`, async () => {\r\n    async function commonPostSetup () {\r\n      const {course, teacher} = await commonSetup();\r\n\r\n      const subDirectory = await new Directory({\r\n        name: 'sub'\r\n      });\r\n      const rootDirectory = new Directory({\r\n        _course: course._id.toString(),\r\n        name: 'root'\r\n      });\r\n\r\n      return {course, teacher, subDirectory, rootDirectory};\r\n    }\r\n\r\n    it('should create a root directory', async () => {\r\n      const {teacher, rootDirectory} = await commonPostSetup();\r\n\r\n      const result = await testHelper.commonUserPostRequest(teacher, '/directory', rootDirectory);\r\n      result.status.should.be.equal(200,\r\n        'could not create root' +\r\n        ' -> ' + result.body.message);\r\n      result.body.__v.should.equal(0);\r\n      result.body.name.should.equal(rootDirectory.name);\r\n      result.body.subDirectories.should.be.instanceOf(Array)\r\n        .and.have.lengthOf(0);\r\n      result.body.files.should.be.instanceOf(Array).and.lengthOf(0);\r\n    });\r\n\r\n    it('should fail to create a root directory for an unauthorized teacher', async () => {\r\n      const {course, rootDirectory} = await commonPostSetup();\r\n      const unauthorizedTeacher = await FixtureUtils.getUnauthorizedTeacherForCourse(course);\r\n\r\n      const result = await testHelper.commonUserPostRequest(unauthorizedTeacher, '/directory', rootDirectory);\r\n      result.status.should.be.equal(403);\r\n    });\r\n\r\n    it('should create a sub directory', async () => {\r\n      const {teacher, rootDirectory, subDirectory} = await commonPostSetup();\r\n      await rootDirectory.save();\r\n\r\n      const result = await testHelper.commonUserPostRequest(teacher, `/directory/${rootDirectory._id}`, subDirectory);\r\n      result.status.should.be.equal(200,\r\n        'could not create subdirectory' +\r\n        ' -> ' + result.body.message);\r\n      result.body.__v.should.equal(0);\r\n      result.body.name.should.equal(subDirectory.name);\r\n      result.body.subDirectories.should.be.instanceOf(Array)\r\n        .and.have.lengthOf(0);\r\n      result.body.files.should.be.instanceOf(Array)\r\n        .and.lengthOf(0);\r\n\r\n      const updatedRoot = (await Directory.findById(rootDirectory));\r\n      updatedRoot.subDirectories.should.be.instanceOf(Array)\r\n        .and.have.lengthOf(1)\r\n        .and.contains(result.body._id);\r\n    });\r\n\r\n    it('should fail to create a sub directory for an unauthorized teacher', async () => {\r\n      const {course, rootDirectory, subDirectory} = await commonPostSetup();\r\n      const unauthorizedTeacher = await FixtureUtils.getUnauthorizedTeacherForCourse(course);\r\n      await rootDirectory.save();\r\n\r\n      const result = await testHelper.commonUserPostRequest(unauthorizedTeacher, `/directory/${rootDirectory._id}`, subDirectory);\r\n      result.status.should.be.equal(403);\r\n    });\r\n\r\n    it('should upload a file', async () => {\r\n      const {teacher, rootDirectory} = await commonPostSetup();\r\n      await rootDirectory.save();\r\n\r\n      const testFileName = 'test_file.txt';\r\n      const testFile = fs.readFileSync('./test/resources/' + testFileName);\r\n\r\n      const result = await chai.request(app)\r\n        .post(`${BASE_URL}/file/${rootDirectory._id}`)\r\n        .set('Cookie', `token=${JwtUtils.generateToken(teacher)}`)\r\n        .attach('file', testFile, testFileName)\r\n        .catch((err) => err.response);\r\n\r\n      result.status.should.be.equal(200,\r\n        'could not upload file' +\r\n        ' -> ' + result.body.message);\r\n      result.body.__v.should.equal(0);\r\n      should.exist(result.body._id);\r\n      should.exist(result.body.mimeType);\r\n      should.exist(result.body.size);\r\n      should.exist(result.body.link);\r\n      result.body.name.should.be.equal(testFileName);\r\n\r\n      const updatedRoot = (await Directory.findById(rootDirectory));\r\n      updatedRoot.files.should.be.instanceOf(Array)\r\n        .and.have.lengthOf(1)\r\n        .and.contains(result.body._id);\r\n    });\r\n\r\n\r\n    it('should upload a file without extension', async () => {\r\n      const {teacher, rootDirectory} = await commonPostSetup();\r\n      await rootDirectory.save();\r\n\r\n      const testFileName = 'test_file_without_extension';\r\n      const testFile = fs.readFileSync('./test/resources/' + testFileName);\r\n\r\n      const result = await chai.request(app)\r\n        .post(`${BASE_URL}/file/${rootDirectory._id}`)\r\n        .set('Cookie', `token=${JwtUtils.generateToken(teacher)}`)\r\n        .attach('file', testFile, testFileName)\r\n        .catch((err) => err.response);\r\n\r\n      result.status.should.be.equal(200,\r\n        'could not upload file' +\r\n        ' -> ' + result.body.message);\r\n      result.body.__v.should.equal(0);\r\n      should.exist(result.body._id);\r\n      should.exist(result.body.mimeType);\r\n      should.exist(result.body.size);\r\n      should.exist(result.body.link);\r\n      result.body.name.should.be.equal(testFileName);\r\n\r\n      const updatedRoot = (await Directory.findById(rootDirectory));\r\n      updatedRoot.files.should.be.instanceOf(Array)\r\n        .and.have.lengthOf(1)\r\n        .and.contains(result.body._id);\r\n    });\r\n\r\n    it('should fail to upload a file for an unauthorized teacher', async () => {\r\n      const {course, rootDirectory} = await commonPostSetup();\r\n      const unauthorizedTeacher = await FixtureUtils.getUnauthorizedTeacherForCourse(course);\r\n      await rootDirectory.save();\r\n\r\n      const testFileName = 'test_file.txt';\r\n      const testFile = fs.readFileSync('./test/resources/' + testFileName);\r\n\r\n      const result = await chai.request(app)\r\n        .post(`${BASE_URL}/file/${rootDirectory._id}`)\r\n        .set('Cookie', `token=${JwtUtils.generateToken(unauthorizedTeacher)}`)\r\n        .attach('file', testFile, testFileName)\r\n        .catch((err) => err.response);\r\n\r\n      result.status.should.be.equal(403);\r\n    });\r\n  });\r\n\r\n  describe(`PUT ${BASE_URL}`, async () => {\r\n    async function commonPutSetup () {\r\n      const {course, teacher} = await commonSetup();\r\n\r\n      const file = new File({\r\n        _course: course._id.toString(),\r\n        name: 'file',\r\n        link: 'test/a',\r\n        size: 129\r\n      });\r\n      const subDirectory = await new Directory({\r\n        _course: course._id.toString(),\r\n        name: 'sub'\r\n      });\r\n      const rootDirectory = new Directory({\r\n        _course: course._id.toString(),\r\n        name: 'root'\r\n      });\r\n\r\n      return {course, teacher, file, subDirectory, rootDirectory};\r\n    }\r\n\r\n    it('should rename a directory', async () => {\r\n      const {teacher, rootDirectory} = await commonPutSetup();\r\n      await rootDirectory.save();\r\n\r\n      const renamedDirectory = rootDirectory;\r\n      renamedDirectory.name = 'renamedRoot';\r\n\r\n      const result = await testHelper.commonUserPutRequest(teacher, `/directory/${rootDirectory._id}`, renamedDirectory);\r\n      result.status.should.be.equal(200,\r\n        'could not rename directory' +\r\n        ' -> ' + result.body.message);\r\n      result.body._id.should.equal(rootDirectory.id);\r\n      result.body.name.should.equal(renamedDirectory.name);\r\n      result.body.subDirectories.should.be.instanceOf(Array)\r\n        .and.have.lengthOf(rootDirectory.subDirectories.length);\r\n      result.body.files.should.be.instanceOf(Array)\r\n        .and.lengthOf(rootDirectory.files.length);\r\n    });\r\n\r\n    it('should fail to update a directory for an unauthorized teacher', async () => {\r\n      const {course, rootDirectory} = await commonPutSetup();\r\n      const unauthorizedTeacher = await FixtureUtils.getUnauthorizedTeacherForCourse(course);\r\n      await rootDirectory.save();\r\n\r\n      const renamedDirectory = rootDirectory;\r\n      renamedDirectory.name = 'renamedRoot';\r\n\r\n      const result = await testHelper.commonUserPutRequest(unauthorizedTeacher, `/directory/${rootDirectory._id}`, renamedDirectory);\r\n      result.status.should.be.equal(403);\r\n    });\r\n\r\n    it('should fail to change the course of a directory to an unauthorized one', async () => {\r\n      const {teacher, rootDirectory} = await commonPutSetup();\r\n      await rootDirectory.save();\r\n      const otherCourse = new Course({name: 'Unauthorized Test Course'});\r\n      await otherCourse.save();\r\n\r\n      const changedDirectory = rootDirectory;\r\n      changedDirectory._course = otherCourse._id.toString();\r\n\r\n      const result = await testHelper.commonUserPutRequest(teacher, `/directory/${rootDirectory._id}`, changedDirectory);\r\n      result.status.should.be.equal(403);\r\n    });\r\n\r\n    it('should rename a file', async () => {\r\n      const {teacher, file} = await commonPutSetup();\r\n      await file.save();\r\n\r\n      const renamedFile = file;\r\n      file.name = 'renamedFile';\r\n\r\n      const result = await testHelper.commonUserPutRequest(teacher, `/file/${file._id}`, renamedFile);\r\n      result.status.should.be.equal(200,\r\n        'could not rename file' +\r\n        ' -> ' + result.body.message);\r\n      result.body._id.should.equal(file.id);\r\n      result.body.name.should.equal(renamedFile.name);\r\n      result.body.link.should.equal(file.link);\r\n      result.body.size.should.equal(file.size);\r\n    });\r\n\r\n    it('should fail to update a file for an unauthorized teacher', async () => {\r\n      const {course, file} = await commonPutSetup();\r\n      const unauthorizedTeacher = await FixtureUtils.getUnauthorizedTeacherForCourse(course);\r\n      await file.save();\r\n\r\n      const renamedFile = file;\r\n      file.name = 'renamedFile';\r\n\r\n      const result = await testHelper.commonUserPutRequest(unauthorizedTeacher, `/file/${file._id}`, renamedFile);\r\n      result.status.should.be.equal(403);\r\n    });\r\n\r\n    it('should fail to change the course of a file to an unauthorized one', async () => {\r\n      const {teacher, file} = await commonPutSetup();\r\n      await file.save();\r\n      const otherCourse = new Course({name: 'Unauthorized Test Course'});\r\n      await otherCourse.save();\r\n\r\n      const changedFile = file;\r\n      changedFile._course = otherCourse._id.toString();\r\n\r\n      const result = await testHelper.commonUserPutRequest(teacher, `/file/${file._id}`, changedFile);\r\n      result.status.should.be.equal(403);\r\n    });\r\n  });\r\n\r\n  describe(`DELETE ${BASE_URL}`, async () => {\r\n    async function commonDeleteSetup () {\r\n      const {course, teacher} = await commonSetup();\r\n\r\n      const subDirectory = await new Directory({\r\n        _course: course._id.toString(),\r\n        name: 'sub'\r\n      }).save();\r\n      const rootDirectory = await new Directory({\r\n        _course: course._id.toString(),\r\n        name: 'root',\r\n        subDirectories: [subDirectory],\r\n      }).save();\r\n\r\n      return {course, teacher, subDirectory, rootDirectory};\r\n    }\r\n\r\n    async function commonDeleteFileSetup (withRootDirectory = true) {\r\n      const {course, teacher} = await commonSetup();\r\n\r\n      const testFileName = fs.readdirSync('./')[0];\r\n      const testFile = fs.readFileSync(testFileName);\r\n      fs.copyFileSync(testFileName, config.uploadFolder + '/test.file');\r\n\r\n      const file = await new File({\r\n        _course: course._id.toString(),\r\n        name: 'root',\r\n        physicalPath: config.uploadFolder + '/test.file',\r\n        link: testFileName,\r\n        size: testFile.length\r\n      }).save();\r\n      const rootDirectory = withRootDirectory && await new Directory({\r\n        _course: course._id.toString(),\r\n        name: 'root',\r\n        files: [file]\r\n      }).save();\r\n\r\n      return {course, teacher, file, rootDirectory};\r\n    }\r\n\r\n    it('should delete a directory', async () => {\r\n      const {teacher, rootDirectory} = await commonDeleteSetup();\r\n\r\n      const result = await testHelper.commonUserDeleteRequest(teacher, `/directory/${rootDirectory._id}`);\r\n      result.status.should.be.equal(200,\r\n        'could not delete directory' +\r\n        ' -> ' + result.body.message);\r\n      should.not.exist(await Directory.findById(rootDirectory));\r\n    });\r\n\r\n    it('should delete a directory and its subdirectories', async () => {\r\n      const {teacher, subDirectory, rootDirectory} = await commonDeleteSetup();\r\n\r\n      const result = await testHelper.commonUserDeleteRequest(teacher, `/directory/${rootDirectory._id}`);\r\n      result.status.should.be.equal(200,\r\n        'could not delete directory' +\r\n        ' -> ' + result.body.message);\r\n      should.not.exist(await Directory.findById(rootDirectory));\r\n      should.not.exist(await Directory.findById(subDirectory));\r\n    });\r\n\r\n\r\n    it('should delete a directory and its files', async () => {\r\n      const {teacher, file, rootDirectory} = await commonDeleteFileSetup(true);\r\n\r\n      const result = await testHelper.commonUserDeleteRequest(teacher, `/directory/${rootDirectory._id}`);\r\n      result.status.should.be.equal(200,\r\n        'could not delete directory' +\r\n        ' -> ' + result.body.message);\r\n      should.not.exist(await Directory.findById(rootDirectory));\r\n      should.not.exist(await File.findById(file));\r\n    });\r\n\r\n    it('should delete a file', async () => {\r\n      const {teacher, file} = await commonDeleteFileSetup(false);\r\n\r\n      const result = await testHelper.commonUserDeleteRequest(teacher, `/file/${file._id}`);\r\n      result.status.should.be.equal(200,\r\n        'could not delete file' +\r\n        ' -> ' + result.body.message);\r\n      should.not.exist(await File.findById(file));\r\n      fs.existsSync(config.uploadFolder + '/test.file').should.be.equal(false);\r\n    });\r\n\r\n    it('should fail to delete a directory for an unauthorized teacher', async () => {\r\n      const {course, rootDirectory} = await commonDeleteSetup();\r\n      const unauthorizedTeacher = await FixtureUtils.getUnauthorizedTeacherForCourse(course);\r\n\r\n      const result = await testHelper.commonUserDeleteRequest(unauthorizedTeacher, `/directory/${rootDirectory._id}`);\r\n      result.status.should.be.equal(403);\r\n    });\r\n\r\n    it('should fail to delete a file for an unauthorized teacher', async () => {\r\n      const {course, file} = await commonDeleteFileSetup(false);\r\n      const unauthorizedTeacher = await FixtureUtils.getUnauthorizedTeacherForCourse(course);\r\n\r\n      const result = await testHelper.commonUserDeleteRequest(unauthorizedTeacher, `/file/${file._id}`);\r\n      result.status.should.be.equal(403);\r\n    });\r\n\r\n    it('should fail when directory not found', async () => {\r\n      const teacher = await FixtureUtils.getRandomTeacher();\r\n\r\n      const result = await testHelper.commonUserDeleteRequest(teacher, '/directory/507f1f77bcf86cd799439011');\r\n      result.status.should.be.equal(404);\r\n    });\r\n\r\n    it('should fail when file not found', async () => {\r\n      const teacher = await FixtureUtils.getRandomTeacher();\r\n\r\n      const result = await testHelper.commonUserDeleteRequest(teacher, '/file/507f1f77bcf86cd799439011');\r\n      result.status.should.be.equal(404);\r\n    });\r\n  });\r\n});\r\n"]}