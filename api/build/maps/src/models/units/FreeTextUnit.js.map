{"version":3,"sources":["src/models/units/FreeTextUnit.ts"],"names":[],"mappings":"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","file":"../../../../src/models/units/FreeTextUnit.js","sourcesContent":["import * as mongoose from 'mongoose';\r\nimport {IUnitModel} from './Unit';\r\nimport {IFreeTextUnit} from '../../../../shared/models/units/IFreeTextUnit';\r\nimport * as MarkdownIt from 'markdown-it';\r\n\r\nconst markdownItEmoji = require('markdown-it-emoji');\r\nconst MarkdownItDeflist = require('markdown-it-deflist');\r\nconst MarkdownItContainer = require('markdown-it-container');\r\nconst MarkdownItMark = require('markdown-it-mark');\r\nconst MarkdownItAbbr = require('markdown-it-abbr');\r\nconst hljs = require('highlight.js');\r\n\r\nconst md = new MarkdownIt({\r\n  highlight: function (str, lang) {\r\n    if (lang && hljs.getLanguage(lang)) {\r\n      try {\r\n        return hljs.highlight(lang, str).value;\r\n      } catch (e) {\r\n        console.error(e);\r\n      }\r\n    }\r\n\r\n    return ''; // use external default escaping\r\n  }\r\n});\r\n\r\n// load MD plugins\r\nmd.use(markdownItEmoji);\r\nmd.use(MarkdownItDeflist);\r\n\r\n// register warning, info, error, success as custom containers\r\nmd.use(MarkdownItContainer, 'warning');\r\nmd.use(MarkdownItContainer, 'info');\r\nmd.use(MarkdownItContainer, 'error');\r\nmd.use(MarkdownItContainer, 'success');\r\nmd.use(MarkdownItContainer, 'learning-objectives');\r\nmd.use(MarkdownItContainer, 'hints');\r\nmd.use(MarkdownItContainer, 'assignment');\r\nmd.use(MarkdownItContainer, 'question');\r\nmd.use(MarkdownItContainer, 'example');\r\nmd.use(MarkdownItContainer, 'todo');\r\n\r\nmd.use(MarkdownItMark);\r\nmd.use(MarkdownItAbbr);\r\n\r\ninterface IFreeTextUnitModel extends IFreeTextUnit, IUnitModel {\r\n  exportJSON: () => Promise<IFreeTextUnit>;\r\n}\r\n\r\nconst freeTextUnitSchema = new mongoose.Schema({\r\n  markdown: {\r\n    type: String,\r\n  }\r\n});\r\n\r\nfreeTextUnitSchema.methods.getTheme = async function () {\r\n  await (<IFreeTextUnitModel>this).populate('_course', 'freeTextStyle').execPopulate();\r\n  return this._course.freeTextStyle;\r\n};\r\n\r\nfreeTextUnitSchema.methods.toHtmlForIndividualPDF = async function () {\r\n  const theme = await this.getTheme();\r\n  let html = '<div id=\"pageHeader\" style=\"text-align: center;border-bottom: 1px solid\">'\r\n    + md.render(this.name ? this.name : '') + md.render(this.description ? this.description : '') + '</div>';\r\n  html += '<div class=\"markdown-wrapper ' + theme + '\">' + md.render(this.markdown ? this.markdown : '') + '</div>';\r\n  return html;\r\n};\r\n\r\nfreeTextUnitSchema.methods.toHtmlForSinglePDF = async function () {\r\n  const theme = await this.getTheme();\r\n  let html = '';\r\n  html += '<div><h4>' + md.render(this.name ? 'Unit: ' + this.name : '') + '</h4>'\r\n    + '<span>' + md.render(this.description ? 'Description: ' + this.description : '') + '</span></div>';\r\n  html += '<div class=\"markdown-wrapper ' + theme + '\">' + md.render(this.markdown ? this.markdown : '') + '</div>';\r\n  return html;\r\n};\r\n\r\nfreeTextUnitSchema.methods.toHtmlForSinglePDFSolutions = function (): String {\r\n  return '';\r\n};\r\n\r\n\r\nexport {freeTextUnitSchema, IFreeTextUnitModel};\r\n"]}