{"version":3,"sources":["src/migrations/scripts/20181019-fileUnit.ts"],"names":[],"mappings":";AAAA,4BAA4B;;;;;;;;;AAE5B,kDAA6C;AAG7C,MAAM,yBAAyB;IAEvB,EAAE;;YACN,MAAM,mBAAmB,GAA0B,MAAM,WAAI,CAAC,IAAI,CAAC,EAAC,GAAG,EAAE,MAAM,EAAE,YAAY,EAAE,EAAC,OAAO,EAAE,KAAK,EAAC,EAAC,CAAC,CAAC;YAElH,KAAK,MAAM,IAAI,IAAI,mBAAmB,EAAE;gBACtC,IAAI;oBACF,IAAI,CAAC,YAAY,GAAG,MAAM,CAAC;oBAC3B,MAAM,IAAI,CAAC,IAAI,CAAC,EAAC,kBAAkB,EAAE,KAAK,EAAC,CAAC,CAAC;iBAC9C;gBAAC,OAAO,KAAK,EAAE;oBACd,OAAO,CAAC,GAAG,CAAC,uCAAuC,GAAG,IAAI,CAAC,IAAI,GAAG,UAAU,GAAG,KAAK,CAAC,CAAC;iBACvF;aACF;YAED,OAAO,IAAI,CAAC;QACd,CAAC;KAAA;CACF;AAED,iBAAS,yBAAyB,CAAC","file":"../../../../src/migrations/scripts/20181019-fileUnit.js","sourcesContent":["// tslint:disable:no-console\r\n\r\nimport {Unit} from '../../models/units/Unit';\r\nimport {IFileUnitModel} from '../../models/units/FileUnit';\r\n\r\nclass FileUnitMigration20181019 {\r\n\r\n  async up() {\r\n    const fileUnitTypeMissing: IFileUnitModel[] = <any>await Unit.find({__t: 'file', fileUnitType: {$exists: false}});\r\n\r\n    for (const unit of fileUnitTypeMissing) {\r\n      try {\r\n        unit.fileUnitType = 'file';\r\n        await unit.save({validateBeforeSave: false});\r\n      } catch (error) {\r\n        console.log('Could not add \"fileUnitType\" to unit ' + unit.name + ' error: ' + error);\r\n      }\r\n    }\r\n\r\n    return true;\r\n  }\r\n}\r\n\r\nexport = FileUnitMigration20181019;\r\n"]}